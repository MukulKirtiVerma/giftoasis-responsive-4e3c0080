
{% extends 'base.html' %}

{% block title %}Add Gift - GiftOasis{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-2xl mx-auto">
        <div class="mb-6">
            <a href="{{ url_for('wishlist_detail', wishlist_id=wishlist.id) }}" class="text-purple-600 hover:text-purple-700 flex items-center">
                <span class="mr-2">‚Üê</span> Back to {{ wishlist.name }}
            </a>
        </div>

        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-gray-900 mb-6">Add a Gift</h1>
                
                <ul class="flex border-b mb-6">
                    <li class="mr-1">
                        <a href="#manual" class="inline-block px-4 py-2 bg-white rounded-t border-l border-t border-r {% if not from_url %}text-purple-600 border-b-2 border-purple-600 font-medium{% else %}text-gray-500 hover:text-gray-700{% endif %}" id="manual-tab">
                            Manual Entry
                        </a>
                    </li>
                    <li class="mr-1">
                        <a href="#url" class="inline-block px-4 py-2 bg-white rounded-t border-l border-t border-r {% if from_url %}text-purple-600 border-b-2 border-purple-600 font-medium{% else %}text-gray-500 hover:text-gray-700{% endif %}" id="url-tab">
                            From URL
                        </a>
                    </li>
                </ul>
                
                <div id="manual-form" class="{% if from_url %}hidden{% endif %}">
                    <form method="POST" action="{{ url_for('add_gift', wishlist_id=wishlist.id) }}" enctype="multipart/form-data">
                        {{ form.hidden_tag() }}
                        
                        <div class="mb-4">
                            {{ form.name.label(class="block text-gray-700 mb-2") }}
                            {{ form.name(class="w-full border border-gray-300 rounded px-4 py-2") }}
                            {% if form.name.errors %}
                                <div class="text-red-500 text-sm mt-1">
                                    {% for error in form.name.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="mb-4">
                            {{ form.description.label(class="block text-gray-700 mb-2") }}
                            {{ form.description(class="w-full border border-gray-300 rounded px-4 py-2 h-24") }}
                            {% if form.description.errors %}
                                <div class="text-red-500 text-sm mt-1">
                                    {% for error in form.description.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                {{ form.price.label(class="block text-gray-700 mb-2") }}
                                {{ form.price(class="w-full border border-gray-300 rounded px-4 py-2") }}
                                {% if form.price.errors %}
                                    <div class="text-red-500 text-sm mt-1">
                                        {% for error in form.price.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            <div>
                                {{ form.category.label(class="block text-gray-700 mb-2") }}
                                {{ form.category(class="w-full border border-gray-300 rounded px-4 py-2") }}
                                {% if form.category.errors %}
                                    <div class="text-red-500 text-sm mt-1">
                                        {% for error in form.category.errors %}
                                            <p>{{ error }}</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            {{ form.image_url.label(class="block text-gray-700 mb-2") }}
                            {{ form.image_url(class="w-full border border-gray-300 rounded px-4 py-2") }}
                            {% if form.image_url.errors %}
                                <div class="text-red-500 text-sm mt-1">
                                    {% for error in form.image_url.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <p class="text-sm text-gray-500 mt-1">Enter the URL of an image for this gift</p>
                        </div>
                        
                        <div class="mb-6">
                            {{ form.source_url.label(class="block text-gray-700 mb-2") }}
                            {{ form.source_url(class="w-full border border-gray-300 rounded px-4 py-2") }}
                            {% if form.source_url.errors %}
                                <div class="text-red-500 text-sm mt-1">
                                    {% for error in form.source_url.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <p class="text-sm text-gray-500 mt-1">Link to where this gift can be purchased (optional)</p>
                        </div>
                        
                        <div class="flex justify-between">
                            <a href="{{ url_for('wishlist_detail', wishlist_id=wishlist.id) }}" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">
                                Cancel
                            </a>
                            {{ form.submit(class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded") }}
                        </div>
                    </form>
                </div>
                
                <div id="url-form" class="{% if not from_url %}hidden{% endif %}">
                    <form method="POST" action="{{ url_for('add_gift_from_url', wishlist_id=wishlist.id) }}">
                        {{ url_form.hidden_tag() }}
                        
                        <div class="mb-6">
                            {{ url_form.url.label(class="block text-gray-700 mb-2") }}
                            {{ url_form.url(class="w-full border border-gray-300 rounded px-4 py-2", placeholder="Paste product URL here...") }}
                            {% if url_form.url.errors %}
                                <div class="text-red-500 text-sm mt-1">
                                    {% for error in url_form.url.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <p class="text-sm text-gray-500 mt-2">
                                Paste a link to a product from any online store. We'll try to automatically extract the product information.
                            </p>
                        </div>
                        
                        <div class="flex justify-between">
                            <a href="{{ url_for('wishlist_detail', wishlist_id=wishlist.id) }}" class="bg-gray-200 text-gray-800 px-4 py-2 rounded hover:bg-gray-300">
                                Cancel
                            </a>
                            {{ url_form.submit(class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded") }}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const manualTab = document.getElementById('manual-tab');
        const urlTab = document.getElementById('url-tab');
        const manualForm = document.getElementById('manual-form');
        const urlForm = document.getElementById('url-form');
        
        manualTab.addEventListener('click', function(e) {
            e.preventDefault();
            manualForm.classList.remove('hidden');
            urlForm.classList.add('hidden');
            manualTab.classList.add('text-purple-600', 'border-b-2', 'border-purple-600', 'font-medium');
            manualTab.classList.remove('text-gray-500', 'hover:text-gray-700');
            urlTab.classList.remove('text-purple-600', 'border-b-2', 'border-purple-600', 'font-medium');
            urlTab.classList.add('text-gray-500', 'hover:text-gray-700');
        });
        
        urlTab.addEventListener('click', function(e) {
            e.preventDefault();
            urlForm.classList.remove('hidden');
            manualForm.classList.add('hidden');
            urlTab.classList.add('text-purple-600', 'border-b-2', 'border-purple-600', 'font-medium');
            urlTab.classList.remove('text-gray-500', 'hover:text-gray-700');
            manualTab.classList.remove('text-purple-600', 'border-b-2', 'border-purple-600', 'font-medium');
            manualTab.classList.add('text-gray-500', 'hover:text-gray-700');
        });
    });
</script>
{% endblock %}
{% endblock %}
